<!DOCTYPE html>
<html lang="en"><head>
<script src="Meeting_2_Ch3_files/libs/clipboard/clipboard.min.js"></script>
<script src="Meeting_2_Ch3_files/libs/quarto-html/tabby.min.js"></script>
<script src="Meeting_2_Ch3_files/libs/quarto-html/popper.min.js"></script>
<script src="Meeting_2_Ch3_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Meeting_2_Ch3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Meeting_2_Ch3_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Meeting_2_Ch3_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.0.38">

  <meta name="author" content="Alejandra Hernandez Segura">
  <title>Hands-On Machine Learning with R</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Meeting_2_Ch3_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Meeting_2_Ch3_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="Meeting_2_Ch3_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="Meeting_2_Ch3_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Meeting_2_Ch3_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Meeting_2_Ch3_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Meeting_2_Ch3_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="center">
  <h1 class="title">Hands-On Machine Learning with R</h1>
  <p class="author">Alejandra Hernandez Segura</p>
</section>

<section id="welcome-back" class="slide level2 middle">
<h2>Welcome (back)!</h2>
<ul>
<li><p>Organized by <span class="citation" data-cites="RLadiesUtrecht">@RLadiesUtrecht</span> and <span class="citation" data-cites="RLadiesDenBosch">@RLadiesDenBosch</span></p></li>
<li><p>Meet-ups every 2 weeks to go through a chapter of the book <a href="https://bradleyboehmke.github.io/HOML/">“Hands-On Machine Learning with R”</a> by Bradley Boehme and Brandon Greenwell</p></li>
<li><p>No session recording!But we will publish the slides and notes!</p></li>
<li><p>We use HackMD for making shared notes and for the registry</p></li>
</ul>
</section>
<section id="how-to-use-hackmd" class="slide level2 center">
<h2>How to use HackMD?</h2>
<p align="center">
</p><p><a href="https://hackmd.io/@Alejandra/SyaQJo4-o/edit"><iframe width="950" height="500" src="https://hackmd.io/@Alejandra/SyaQJo4-o/edit" alt="Frame of our HackMD document of this week" display="block"></iframe></a></p>
<p></p>

<aside><div>
<p>https://hackmd.io/<span class="citation" data-cites="Alejandra/SyaQJo4-o/edit">@Alejandra/SyaQJo4-o/edit</span></p>
</div></aside></section>
<section id="house-rules" class="slide level2 smaller">
<h2>House rules</h2>
<div>
<ul>
<li class="fragment"><p>Remember the <a href="https://rladies.org/code-of-conduct/">R-Ladies code of conduct</a>. In summary, please be nice to each other and help us make an <strong>inclusive</strong> meeting! <span style="{&quot;color&quot;:&quot;purple&quot;}"><svg aria-hidden="true" role="img" viewbox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M0 190.9V185.1C0 115.2 50.52 55.58 119.4 44.1C164.1 36.51 211.4 51.37 244 84.02L256 96L267.1 84.02C300.6 51.37 347 36.51 392.6 44.1C461.5 55.58 512 115.2 512 185.1V190.9C512 232.4 494.8 272.1 464.4 300.4L283.7 469.1C276.2 476.1 266.3 480 256 480C245.7 480 235.8 476.1 228.3 469.1L47.59 300.4C17.23 272.1 .0003 232.4 .0003 190.9L0 190.9z"></path></svg></span></p></li>
<li class="fragment"><p>The meeting will NOT BE RECORDED but the slides will be shared!</p></li>
<li class="fragment"><p>Please list your name in the registry</p>
<ul>
<li class="fragment">Make sure you’re in the edit mode (ctrl + alt + e) when trying to edit the file! You’ll know you’re in the edit mode if the background is black :8ball:</li>
</ul></li>
<li class="fragment"><p>Please keep your mic off during the presentation. It is nice if you have the camera on and participate to make the meeting more interactive. Of course you can have your camera off if you prefer</p></li>
<li class="fragment"><p>If you have questions, raise your hand or write your question in HackMD or in the chat.</p></li>
</ul>
</div>
</section>
<section id="what-did-we-learn-last-time" class="slide level2 smaller">
<h2>What did we learn last time?</h2>
<div>
<ul>
<li class="fragment"><p><strong>Supervised learners</strong> predict. They can be continuous or categorical</p></li>
<li class="fragment"><p><strong>Unsupervised learners</strong> describe. They can be defined by rows (clustering) or columns (dimension reduction). Building a machine learning model is an iterative process</p></li>
<li class="fragment"><p><strong>Splitting data</strong> into training (~70%) and testing data (~30%)</p></li>
<li class="fragment"><p>You usually do a <strong>K-fold cross-validation</strong></p></li>
<li class="fragment"><p><strong>Bootstrapping:</strong> re-sampling data with replacement. It is an alternative to K-fold cross validation.</p></li>
<li class="fragment"><p><strong>Bias:</strong> how far off are your models prediction from the true value</p></li>
<li class="fragment"><p><strong>Variance:</strong> the variability of a model prediction (eg. overfitting -&gt; no error in training data)</p></li>
</ul>
</div>
</section>
<section id="the-dataset" class="slide level2 smaller">
<h2>The dataset</h2>
<ul>
<li>Property sales information as described in De Cock (2011).
<ul>
<li><strong>problem type:</strong> supervised regression</li>
<li><strong>response variable:</strong> <code>Sale_Price</code> (i.e., $195,000, $215,000)</li>
<li><strong>features:</strong> 80</li>
<li><strong>observations:</strong> 2,930</li>
<li><strong>objective:</strong> use property attributes to predict the sale price of a home</li>
<li><strong>access:</strong> provided by the AmesHousing package (Kuhn 2017a)</li>
<li><strong>more details:</strong> See <code>?AmesHousing::ames_raw</code></li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># access data</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>ames <span class="ot">&lt;-</span> AmesHousing<span class="sc">::</span><span class="fu">make_ames</span>()</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># response variable</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">head</span>(ames<span class="sc">$</span>Sale_Price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 215000 105000 172000 244000 189900 195500</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Stratified sampling with the rsample package</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>split <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(ames, <span class="at">prop =</span> <span class="fl">0.7</span>, </span>
<span id="cb3-4"><a href="#cb3-4"></a>                       <span class="at">strata =</span> <span class="st">"Sale_Price"</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a>ames_train  <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(split)</span>
<span id="cb3-6"><a href="#cb3-6"></a>ames_test   <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section>
<section id="chapter-3-feature-and-target-engineering" class="title-slide slide level1 center">
<h1>Chapter 3: Feature and Target Engineering</h1>
<div class="fragment">
<p><br> <br></p>
<blockquote>
<p>Live with your data before you plunge into modeling</p>
</blockquote>
<p><br></p>
</div>
<div class="fragment">
<div class="smaller righttxt">
<p>Breiman and others 2001, 201</p>
</div>
</div>
</section>
<section id="data-processing-and-engineering" class="slide level2">
<h2>Data Processing and engineering</h2>
<blockquote>
<p>addition, deletion, or transformation of data</p>
</blockquote>
<p><strong>Important packages:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Helper packages</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="fu">library</span>(visdat)</span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co"># Feature engineering packages</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="fu">library</span>(caret)</span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="fu">library</span>(recipes)</span>
<span id="cb4-9"><a href="#cb4-9"></a></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co"># Modeling packages</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="fu">library</span>(caret)    <span class="co"># for cross-validation, etc.</span></span>
<span id="cb4-12"><a href="#cb4-12"></a></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co"># Model interpretability packages</span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="fu">library</span>(vip)      <span class="co"># variable importance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="target-engineering" class="slide level2">
<h2>Target engineering</h2>

<img data-src="assets/optimus-prime-trucker.gif" alt="GIF of the 'transformer' Optimus Prime" class="r-stretch quarto-figure-center"></section>
<section id="section" class="slide level2">
<h2></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>ames_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Sale_Price <span class="sc">~</span> ., <span class="at">data =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">step_log</span>(<span class="fu">all_outcomes</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="assets/2_engineering-skewed-residuals-1.png" data-out.width="60%" alt="Distribution of the residuals with and without log transformation. The log-transformed ones follow a normal distribution and fix the skewedness of the non-log transformed ones."></p>
<p></p><figcaption>Transforming the response variable to minimize skewness can resolve concerns with non-normally distributed errors</figcaption><p></p>
</figure>
</div>
<aside class="notes">
<ul>
<li><p>Can lead to predictive improvement</p></li>
<li><p>Especially important for parametric models (that require assumptions)</p></li>
<li><p>Remember to undo the transformation before interpreting!</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="dealing-with-missingness" class="slide level2">
<h2>Dealing with missingness</h2>

<img data-src="assets/something-feels-missing-the-encore.gif" alt="GIF of a woman saying 'Something feels missing'" class="r-stretch quarto-figure-center"></section>
<section id="why-do-we-miss-data" class="slide level2 smaller">
<h2>Why do we miss data?</h2>
<div>
<ul>
<li class="fragment"><em>Informative missingness</em>: structural cause. E.g. deficiencies in data collection, abnormalities in the observational environment.
<ul>
<li class="fragment">May get their own ‘category’ (e.g.&nbsp;<code>None</code>) to not affect predictability</li>
</ul></li>
<li class="fragment"><em>Missingness at random</em>: independent of data collection
<ul>
<li class="fragment">May be deleted or imputed</li>
</ul></li>
</ul>
<h3 id="what-do-we-do-if-we-miss-data">What do we do if we miss data?</h3>
<ul>
<li class="fragment"><p>Most models need you to handle missingness!!!</p></li>
<li class="fragment"><p>Few models (mainly tree-based) deal with missing values already</p></li>
<li class="fragment"><p><strong>Note:</strong> Often you will compare multiple models during your analysis process, so you often have to handle missing values anyway!</p></li>
</ul>
</div>
</section>
<section id="visualize-missing-values" class="slide level2 smaller">
<h2>Visualize missing values</h2>
<div class="columns">
<div class="column" style="width:35%;">
<p>We will use the raw data:</p>
<pre><code>AmesHousing::ames_raw %&gt;%
  is.na() %&gt;%
  reshape2::melt() %&gt;%
  ggplot(aes(Var2, Var1, fill=value)) + 
    geom_raster() + 
    coord_flip() +
    scale_y_continuous(NULL, expand = c(0, 0)) +
    scale_fill_grey(name = "", 
                    labels = c("Present", 
                               "Missing")) +
    xlab("Observation") +
    theme(axis.text.y  = element_text(size = 4))</code></pre>
</div><div class="column" style="width:65%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="Meeting_2_Ch3_files/figure-revealjs/unnamed-chunk-5-1.png" style="width:120.0%"></p>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>AmesHousing<span class="sc">::</span>ames_raw <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(<span class="st">`</span><span class="at">Garage Type</span><span class="st">`</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Garage Type</span><span class="st">`</span>, <span class="st">`</span><span class="at">Garage Cars</span><span class="st">`</span>, <span class="st">`</span><span class="at">Garage Area</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 157 × 3
   `Garage Type` `Garage Cars` `Garage Area`
   &lt;chr&gt;                 &lt;int&gt;         &lt;int&gt;
 1 &lt;NA&gt;                      0             0
 2 &lt;NA&gt;                      0             0
 3 &lt;NA&gt;                      0             0
 4 &lt;NA&gt;                      0             0
 5 &lt;NA&gt;                      0             0
 6 &lt;NA&gt;                      0             0
 7 &lt;NA&gt;                      0             0
 8 &lt;NA&gt;                      0             0
 9 &lt;NA&gt;                      0             0
10 &lt;NA&gt;                      0             0
# … with 147 more rows</code></pre>
</div>
</div>
</section>
<section id="imputation" class="slide level2 smaller">
<h2>Imputation</h2>
<blockquote>
<p>Imputation is the process of replacing a missing value with a substituted, “best guess” value</p>
</blockquote>
<p>Different ways to impute data:</p>
<ul>
<li>Estimated statistic: mean, median or mode
<ul>
<li>Simplistic<br>
</li>
</ul></li>
<li>Group statistics: capture expected values based on similar groups
<ul>
<li>Infeasible for larger datasets</li>
</ul></li>
<li>Modeling imputation: use a model to impute data. Often K-nearest neighbor and tree-based imputation
<ul>
<li>Computationally demanding</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>ames_recipe <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">step_impute_median</span>(Gr_Liv_Area)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Recipe

Inputs:

      role #variables
   outcome          1
 predictor         80

Operations:

Log transformation on all_outcomes()
Median imputation for Gr_Liv_Area</code></pre>
</div>
</div>
<p>:: {.incremental}</p>
<h3 class="smaller" id="imputation-with-k-nearest-neighbor-knn">Imputation with K-nearest neighbor (KNN)</h3>
<ol type="1">
<li>Identifies observations with missing values</li>
<li>Identifies other observations that are similar based on the other available features</li>
<li>Uses the values from these nearest neighbor observations to impute missing values.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># Number of neighbors can be chosen!</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>ames_recipe <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">step_impute_knn</span>(<span class="fu">all_predictors</span>(), <span class="at">neighbors =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Recipe

Inputs:

      role #variables
   outcome          1
 predictor         80

Operations:

Log transformation on all_outcomes()
K-nearest neighbor imputation for all_predictors()</code></pre>
</div>
</div>
<h3 class="smaller" id="imputation-with-tree-based-methods">Imputation with tree-based methods</h3>
<ul>
<li><p>Often can be constructed in the presence of missing values</p></li>
<li><p>Some (like random forest) are computationally demanding. Others (like bagged trees) can be a good compromise between accuracy and computational burden.</p></li>
</ul>
<ol type="1">
<li>Observations with missing values are identified</li>
<li>Feature containing the missing value is treated as the target and predicted using bagged decision trees</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>ames_recipe <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">step_impute_bag</span>(<span class="fu">all_predictors</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Recipe

Inputs:

      role #variables
   outcome          1
 predictor         80

Operations:

Log transformation on all_outcomes()
Bagged tree imputation for all_predictors()</code></pre>
</div>
</div>
<p>:::</p>
</section>
<section id="section-1" class="slide level2">
<h2></h2>

<img data-src="assets/2_imputation.png" alt="Panel of four scatter plots showing the Ames data with the actual values and how the three different methods discussed (mean imputation, KNN imputation and bagged trees imputation would imput the data" class="r-stretch quarto-figure-center"><p class="caption">Comparison of three different imputation methods.</p></section>
<section id="feature-filtering" class="slide level2 smaller">
<h2>Feature filtering</h2>
<ul>
<li>When we have too many features!
<ul>
<li>Hard to interpret</li>
<li>Computationally costly</li>
<li>Many are non-informative predictors –&gt; some models resist this disadvantage (e.g.&nbsp;the Lasso and tree-based methods)</li>
</ul></li>
<li>Near-zero variance variables are easy to eliminate!
<ul>
<li>The fraction of unique values over the sample size is low (≤ 10%)</li>
<li>The ratio of the frequency of the most prevalent value to the frequency of the second most prevalent value is large (≥20%)</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>caret<span class="sc">::</span><span class="fu">nearZeroVar</span>(ames_train, <span class="at">saveMetrics =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">filter</span>(nzv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              rowname  freqRatio percentUnique zeroVar  nzv
1              Street  226.66667    0.09760859   FALSE TRUE
2               Alley   24.25316    0.14641288   FALSE TRUE
3        Land_Contour   19.50000    0.19521718   FALSE TRUE
4           Utilities 1023.00000    0.14641288   FALSE TRUE
5          Land_Slope   22.15909    0.14641288   FALSE TRUE
6         Condition_2  202.60000    0.34163006   FALSE TRUE
7           Roof_Matl  144.35714    0.39043436   FALSE TRUE
8           Bsmt_Cond   20.24444    0.29282577   FALSE TRUE
9      BsmtFin_Type_2   25.85294    0.34163006   FALSE TRUE
10       BsmtFin_SF_2  453.25000    9.37042460   FALSE TRUE
11            Heating  106.00000    0.29282577   FALSE TRUE
12    Low_Qual_Fin_SF 1010.50000    1.31771596   FALSE TRUE
13      Kitchen_AbvGr   21.23913    0.19521718   FALSE TRUE
14         Functional   38.89796    0.39043436   FALSE TRUE
15     Enclosed_Porch  102.05882    7.41825281   FALSE TRUE
16 Three_season_porch  673.66667    1.12249878   FALSE TRUE
17       Screen_Porch  169.90909    4.63640800   FALSE TRUE
18          Pool_Area 2039.00000    0.53684724   FALSE TRUE
19            Pool_QC  509.75000    0.24402147   FALSE TRUE
20       Misc_Feature   34.18966    0.24402147   FALSE TRUE
21           Misc_Val  180.54545    1.56173743   FALSE TRUE</code></pre>
</div>
</div>
<ul>
<li>We can add <code>step_zv()</code> and <code>step_nzv()</code> to our <code>ames_recipe</code> to remove zero or near-zero variance features.</li>
</ul>
</section>
<section id="numeric-feature-engineering" class="slide level2 middle">
<h2>Numeric feature engineering</h2>
<div class="columns">
<div class="column">
<ul>
<li><p>Problems:</p>
<ul>
<li>Skeweness</li>
<li>Outliers</li>
<li>Wide range of magnitudes</li>
</ul></li>
<li><p>Tree-based models are relatively immune to these problems</p></li>
</ul>
</div><div class="column">
<p><img data-src="assets/math-calculate.gif" alt="GIF of woman that seems to be struggling with math calculations."></p>
</div>
</div>
</section>
<section id="numeric-feature-engineering.-skewness" class="slide level2 smaller">
<h2>Numeric feature engineering. Skewness</h2>
<p><strong>Option 1:</strong> log transformation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># Single step</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>transformed_response <span class="ot">&lt;-</span> <span class="fu">log</span>(ames_train<span class="sc">$</span>Sale_Price)</span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co"># As a recipe --&gt; better to be re-applied strategically</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>ames_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Sale_Price <span class="sc">~</span> ., <span class="at">data =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>  <span class="fu">step_log</span>(<span class="fu">all_outcomes</span>())</span>
<span id="cb17-7"><a href="#cb17-7"></a>ames_recipe</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Recipe

Inputs:

      role #variables
   outcome          1
 predictor         80

Operations:

Log transformation on all_outcomes()</code></pre>
</div>
</div>
<p><strong>Note:</strong> negative values or zero will produce <code>NaN</code> and <code>-Inf</code>! To solve that you can apply a small offset</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># Single step. Will ad 1 to the value before log transforming</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>transformed_response_1off <span class="ot">&lt;-</span> <span class="fu">log1p</span>(ames_train<span class="sc">$</span>Sale_Price)</span>
<span id="cb19-3"><a href="#cb19-3"></a></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co"># As a recipe. Will apply an offset of 1</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>ames_recipe_1off <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Sale_Price <span class="sc">~</span> ., <span class="at">data =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb19-6"><a href="#cb19-6"></a>  <span class="fu">step_log</span>(<span class="fu">all_outcomes</span>(), <span class="at">offset=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="numeric-feature-engineering.-skewness-1" class="slide level2 smaller">
<h2>Numeric feature engineering. Skewness</h2>
<p><strong>Option 2:</strong> use a Box Cox transformation. It will find an appropriate transformation from a family of power transforms that will transform the variable as close as possible to a normal distribution (Box and Cox 1964; Carroll and Ruppert 1981).</p>
<ul>
<li><p>At the core of the Box Cox transformation is an exponent, lambda (λ), which varies from -5 to 5.</p></li>
<li><p>All values of λ are considered. Best one is chosen from training data and applied to training AND test set.</p></li>
<li><p>If your response has negative values, the Yeo-Johnson transformation is very similar to the Box-Cox but does not require the input variables to be strictly positive. To apply, use <code>step_YeoJohnson()</code>.</p></li>
</ul>

<img data-src="assets/2_engineering-distribution-comparison-1.png" data-fig.alt="Distributions of the dataset without transformation (skewed), with log transformation (normal distributed) and with BoxCox transformation (also normal)." data-out.width="60%" class="r-stretch quarto-figure-center"><p class="caption">Response variable transformations.</p></section>
<section id="numeric-feature-engineering.-standardization" class="slide level2 smaller">
<h2>Numeric feature engineering. Standardization</h2>
<div>
<ul>
<li class="fragment"><p>What are the largest and smallest values across all features and do they span several orders of magnitude?</p>
<ul>
<li class="fragment">Especially important for algorithms using linear functions!</li>
</ul></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="assets/2_standardizing-1.png" alt="Dot plots comparing the distribution of values before and after standardization. The values of the standardized variables seem more comparable because they are in the same scale."></p>
<p></p><figcaption>Standardizing features allows all features to be compared on a common value scale regardless of their real value differences.</figcaption><p></p>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>ames_recipe <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="fu">step_center</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="fu">step_scale</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Recipe

Inputs:

      role #variables
   outcome          1
 predictor         80

Operations:

Log transformation on all_outcomes()
Centering for all_numeric(), -all_outcomes()
Scaling for all_numeric(), -all_outcomes()</code></pre>
</div>
</div>
</div>
</section>
<section id="categorical-feature-engineering" class="slide level2 middle">
<h2>Categorical feature engineering</h2>
<ul>
<li><p>Most models require numeric predictors</p></li>
<li><p>Even if they don’t, models often benefit from pre-processing of categorical variables</p></li>
</ul>

<img data-src="assets/weird_category.gif" alt="GIF of a blogger reviewing a product and saying 'This fits in the kind of weird, unique, strange, category'." class="r-stretch quarto-figure-center"></section>
<section id="categorical-feature-engineering.-lumping" class="slide level2 smaller">
<h2>Categorical feature engineering. Lumping</h2>
<div>
<ul>
<li class="fragment"><p>‘Lumping’ means collapsing data into less categories</p></li>
<li class="fragment"><p>Useful when some of your categories are almost empty</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">count</span>(ames_train, Neighborhood) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 28 × 2
   Neighborhood            n
   &lt;fct&gt;               &lt;int&gt;
 1 Landmark                1
 2 Green_Hills             2
 3 Greens                  3
 4 Blueste                 8
 5 Veenker                15
 6 Northpark_Villa        17
 7 Bloomington_Heights    18
 8 Meadow_Village         22
 9 Briardale              23
10 Clear_Creek            26
# … with 18 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># Lump levels for two features</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>lumping <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Sale_Price <span class="sc">~</span> ., <span class="at">data =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">step_other</span>(Neighborhood, <span class="at">threshold =</span> <span class="fl">0.01</span>, </span>
<span id="cb24-4"><a href="#cb24-4"></a>             <span class="at">other =</span> <span class="st">"other"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>  <span class="fu">step_other</span>(Screen_Porch, <span class="at">threshold =</span> <span class="fl">0.1</span>, </span>
<span id="cb24-6"><a href="#cb24-6"></a>             <span class="at">other =</span> <span class="st">"&gt;0"</span>)</span>
<span id="cb24-7"><a href="#cb24-7"></a></span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="co"># Apply this blue print --&gt; you will learn about this at </span></span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="co"># the end of the chapter</span></span>
<span id="cb24-10"><a href="#cb24-10"></a>apply_2_training <span class="ot">&lt;-</span> <span class="fu">prep</span>(lumping, <span class="at">training =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb24-11"><a href="#cb24-11"></a>  <span class="fu">bake</span>(ames_train)</span>
<span id="cb24-12"><a href="#cb24-12"></a></span>
<span id="cb24-13"><a href="#cb24-13"></a><span class="co"># New distribution of Neighborhood</span></span>
<span id="cb24-14"><a href="#cb24-14"></a><span class="fu">count</span>(apply_2_training, Neighborhood) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 22 × 2
   Neighborhood                                n
   &lt;fct&gt;                                   &lt;int&gt;
 1 Meadow_Village                             22
 2 Briardale                                  23
 3 Clear_Creek                                26
 4 South_and_West_of_Iowa_State_University    32
 5 Stone_Brook                                40
 6 Northridge                                 51
 7 Timberland                                 52
 8 other                                      64
 9 Brookside                                  74
10 Crawford                                   75
# … with 12 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="categorical-feature-engineering.-one-hot-and-dummy-encoding" class="slide level2 smaller">
<h2>Categorical feature engineering. One-hot and dummy encoding</h2>
<div>
<ul>
<li class="fragment">Two common methods:</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="assets/2_ohe-vs-dummy.png" alt="Diagram showing one-hot encoding in which each categorical variable becomes a boolean. To avoid collinearity, the dummy encoding does the same but dropping one of the levels."></p>
<p></p><figcaption>Eight observations containing a categorical feature X and the difference in how one-hot and dummy encoding transforms this feature.</figcaption><p></p>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">recipe</span>(Sale_Price <span class="sc">~</span> ., <span class="at">data =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>(), <span class="at">one_hot =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Recipe

Inputs:

      role #variables
   outcome          1
 predictor         80

Operations:

Dummy variables from all_nominal()</code></pre>
</div>
</div>
</div>
<aside class="notes">
<ul>
<li>Dummy encoding helps avoiding perfect collinearity</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="categorical-feature-engineering.-ordinal-encoding" class="slide level2 smaller">
<h2>Categorical feature engineering. Ordinal encoding</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="fu">count</span>(ames_train, Overall_Qual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   Overall_Qual       n
   &lt;fct&gt;          &lt;int&gt;
 1 Very_Poor          3
 2 Poor               9
 3 Fair              33
 4 Below_Average    147
 5 Average          580
 6 Above_Average    521
 7 Good             408
 8 Very_Good        242
 9 Excellent         82
10 Very_Excellent    24</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">recipe</span>(Sale_Price <span class="sc">~</span> ., <span class="at">data =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>  <span class="fu">step_integer</span>(Overall_Qual) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3"></a>  <span class="fu">prep</span>(ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4"></a>  <span class="fu">bake</span>(ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>  <span class="fu">count</span>(Overall_Qual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   Overall_Qual     n
          &lt;dbl&gt; &lt;int&gt;
 1            1     3
 2            2     9
 3            3    33
 4            4   147
 5            5   580
 6            6   521
 7            7   408
 8            8   242
 9            9    82
10           10    24</code></pre>
</div>
</div>
<p><span style="color:red">WARNING!!!</span> Models often take these labels as numeric! Careful when you use them in variables that are not ordinal.</p>
<aside class="notes">
<p>There are other types of categorical encoding. The book mentions ‘target encoding’ but I skip it because it causes data leakage.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="dimension-reduction" class="slide level2">
<h2>Dimension reduction</h2>
<ul>
<li><p>Alternative to filter out non-informative features without manually removing them</p></li>
<li><p>Principal Component Analysis is a well-known approach</p>
<ul>
<li>You can then retain components that explain ~95% of the variance</li>
</ul></li>
</ul>
<div class="columns">
<div class="column">
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">recipe</span>(Sale_Price <span class="sc">~</span> ., <span class="at">data =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>  <span class="fu">step_center</span>(<span class="fu">all_numeric</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>  <span class="fu">step_scale</span>(<span class="fu">all_numeric</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>  <span class="fu">step_pca</span>(<span class="fu">all_numeric</span>(), <span class="at">threshold =</span> .<span class="dv">95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Recipe

Inputs:

      role #variables
   outcome          1
 predictor         80

Operations:

Centering for all_numeric()
Scaling for all_numeric()
PCA extraction with all_numeric()</code></pre>
</div>
</div>
</div><div class="column">
<div class="quarto-figure quarto-figure-right">
<figure>
<p><img data-src="assets/menger-sponge.gif" alt="GIF of a fractal moving and getting closer, representing different dimensions"></p>
</figure>
</div>
</div>
</div>
<aside class="notes">
<ul>
<li>It will be discussed in ch.&nbsp;17-19</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="proper-implementation" class="slide level2 smaller">
<h2>Proper implementation</h2>
<div class="columns">
<div class="column">
<div>
<ul>
<li class="fragment"><p>Use <strong>sequential steps</strong>: some pre-processing may affect other steps and therefore the model!</p>
<ul>
<li class="fragment">Filter out zero or near-zero variance features</li>
<li class="fragment">Imputation</li>
<li class="fragment">Resolve skewness (normalize)</li>
<li class="fragment">Standardize (center and scale) numeric features</li>
<li class="fragment">Dimension reduction on numeric features</li>
<li class="fragment">One-hot or dummy encode categorical features</li>
</ul></li>
</ul>
</div>
</div><div class="column">
<div class="quarto-figure quarto-figure-right">
<figure>
<p><img data-src="assets/recipe.gif" alt="GIF of woman saying that she wants a recipe"></p>
</figure>
</div>
</div>
</div>
<div>
<ul>
<li class="fragment"><p>Beware of <strong>data leakage</strong>: so info outside the training data is used to create the model.</p>
<ul>
<li class="fragment">Apply the transformations after each re-sampling step.</li>
</ul></li>
<li class="fragment"><p>Put the steps together into a pipeline/workflow/recipe and then apply it to the data</p></li>
</ul>
</div>
<aside class="notes">
<ul>
<li><p>Don’t center data before Box-Cox transformation. You may get non-positive values.</p></li>
<li><p>Lumping infrequent categories before one-hot/dummy encoding.</p></li>
<li><p>Dimension reduction procedures are usually done only in numeric features.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="section-2" class="slide level2 smaller">
<h2></h2>
<p><strong>Recipe</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>blueprint <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Sale_Price <span class="sc">~</span> ., <span class="at">data =</span> ames_train) <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>  <span class="fu">step_nzv</span>(<span class="fu">all_nominal</span>())  <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="fu">step_integer</span>(<span class="fu">matches</span>(<span class="st">"Qual|Cond|QC|Qu"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4"></a>  <span class="fu">step_center</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5"></a>  <span class="fu">step_scale</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6"></a>  <span class="fu">step_pca</span>(<span class="fu">all_numeric</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Apply it</strong></p>
<div class="cell" data-hash="Meeting_2_Ch3_cache/revealjs/unnamed-chunk-21_8b84fe8df9741882f37bbc878fcb76b2">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># Specify resampling plan</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>cv <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(</span>
<span id="cb35-3"><a href="#cb35-3"></a>  <span class="at">method =</span> <span class="st">"repeatedcv"</span>, </span>
<span id="cb35-4"><a href="#cb35-4"></a>  <span class="at">number =</span> <span class="dv">10</span>, </span>
<span id="cb35-5"><a href="#cb35-5"></a>  <span class="at">repeats =</span> <span class="dv">5</span></span>
<span id="cb35-6"><a href="#cb35-6"></a>)</span>
<span id="cb35-7"><a href="#cb35-7"></a></span>
<span id="cb35-8"><a href="#cb35-8"></a><span class="co"># Construct grid of hyperparameter values</span></span>
<span id="cb35-9"><a href="#cb35-9"></a>hyper_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">k =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">25</span>, <span class="at">by =</span> <span class="dv">1</span>))</span>
<span id="cb35-10"><a href="#cb35-10"></a></span>
<span id="cb35-11"><a href="#cb35-11"></a><span class="co"># Tune a knn model using grid search</span></span>
<span id="cb35-12"><a href="#cb35-12"></a>knn_fit2 <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb35-13"><a href="#cb35-13"></a>  blueprint, </span>
<span id="cb35-14"><a href="#cb35-14"></a>  <span class="at">data =</span> ames_train, </span>
<span id="cb35-15"><a href="#cb35-15"></a>  <span class="at">method =</span> <span class="st">"knn"</span>, </span>
<span id="cb35-16"><a href="#cb35-16"></a>  <span class="at">trControl =</span> cv, </span>
<span id="cb35-17"><a href="#cb35-17"></a>  <span class="at">tuneGrid =</span> hyper_grid,</span>
<span id="cb35-18"><a href="#cb35-18"></a>  <span class="at">metric =</span> <span class="st">"RMSE"</span></span>
<span id="cb35-19"><a href="#cb35-19"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<p>Remember to undo the transformation before interpreting!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="exercises" class="title-slide slide level1 center">
<h1>Exercises</h1>

</section>
<section id="ex.-1-with-which-concept-do-you-think-that-survivorship-bias-is-related" class="slide level2 smaller">
<h2>Ex. 1: With which concept do you think that ‘survivorship bias’ is related?</h2>
<blockquote>
<p><strong>Survivorship bias</strong>, or <strong>survival bias</strong>, is the logical error of concentration on the people or things that ‘survived’ some process and inadvertently overlooking those that did not because of their lack of visibility</p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="assets/survival-bias.jpeg" alt="Drawing of the surviving aircrafts showing the places where they got the most bullets (wings and body) and where they got (almost) no bullets (engine and fans)."></p>
</figure>
</div>
<ul>
<li><strong>Original recommendation</strong>: reinforce areas on aircrafts that suffer most damage</li>
</ul>
<aside class="notes">
<ul>
<li>WWII</li>
<li>Researchers from the Center for Naval Analyses</li>
<li>Abraham Wald (statistician) realized that aircrafts that had <em>not survived</em> the mission were not being considered. He proposed reinforcing the areas where the returning aircraft were unscathed (blue).</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="answer-ex.-1-informative-missingness-missing-values" class="slide level2">
<h2>Answer Ex. 1: Informative missingness (missing values)</h2>
<div class="columns">
<div class="column">
<p><br> <br> <br></p>
<p><strong>Wald’s recommendation</strong>: Reinforce areas where the returning aircraft were unscathed.</p>
</div><div class="column">
<p><img data-src="assets/something-feels-missing-the-encore.gif" alt="GIF of woman saying 'Something feels missing'"></p>
</div>
</div>
</section>
<section id="ex.-2-what-kind-of-preparation-would-you-do-to-be-able-to-easily-compare-the-size-of-the-bodies-in-the-solar-system" class="slide level2">
<h2>Ex. 2: What kind of preparation would you do to be able to easily compare the size of the bodies in the Solar System?</h2>
<div class="columns">
<div class="column">
<p><img data-src="assets/solar-system.png" alt="Barplot showing the sizes of bodies in the solar system. Only the sun is visible."></p>
</div><div class="column">
<p><img data-src="assets/solar-system-real.jpg" alt="Pictures of the solar system showing the difference in sizes of different celestial bodies."></p>
</div>
</div>
</section>
<section id="answer-ex.-2-logarithmic-transformation" class="slide level2">
<h2>Answer Ex. 2: Logarithmic transformation</h2>
<div class="columns">
<div class="column">
<p><br> <br> <img data-src="assets/solar-system-log.png" alt="Barplot showing the sizes of bodies in the solar system after doing a logarithmic transformation. All the bodies are now visible."></p>
</div><div class="column">
<p><br> <br> <img data-src="assets/optimus-prime-trucker.gif" data-fig-align="center" alt="GIF of the transformer Optimus Prime"></p>
</div>
</div>
</section>
<section id="how-much-stronger-was-mexicos-earthquake-why-is-it-difficult-to-interpret-richters-scale" class="slide level2 smaller">
<h2>How much stronger was Mexico’s earthquake? Why is it difficult to interpret Richter’s scale?</h2>
<div class="fragment">
<p><img data-src="assets/bali-earthquake.png" alt="Screenshot of a google search of a moderate earthquake (5 Ricther) in Bali in April 2017."></p>
</div>
<div class="fragment">
<div class="quarto-figure quarto-figure-right">
<figure>
<p><img data-src="assets/mexico-earthquake.png" alt="Screenshot of a new report of a 'huge magnitude earthquake' (7.1 Richter) in central Mexico that caused massive disaster."></p>
</figure>
</div>
</div>
</section>
<section id="answer-ex.-3-100-times-higher.-difficult-to-interpret-because-we-need-to-re-transform-before-interpreting" class="slide level2">
<h2>Answer Ex. 3: 100 times higher. Difficult to interpret because we need to re-transform before interpreting</h2>
<div class="columns">
<div class="column" style="width:70%;">
<blockquote>
<p>Due to the variance in earthquakes, it is essential to understand the Richter scale uses logarithms simply to make the measurements manageable (i.e., a magnitude 3 quake factors 10³ while a magnitude 5 quake is 100 times stronger than that) (Wikipedia)</p>
</blockquote>
</div><div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-right">
<figure>
<p><img data-src="assets/math-calculate.gif" alt="GIF of woman struggling doing math calculations."></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ex.-4-label-encoding-similar-to-ordinal-encoding-can-be-good-for-transforming-the-target-variable-if-it-is-categorical-not-ordinal.-why" class="slide level2 smaller">
<h2>Ex. 4: Label encoding (similar to Ordinal encoding) can be good for transforming the target variable if it is categorical (not ordinal). Why?</h2>
<ul>
<li>When talking about ‘Ordinal Encoding’ I said:</li>
</ul>
<blockquote>
<p>Careful when you use them in variables that are not ordinal.</p>
</blockquote>
<ul>
<li>Stephen Allwright (D.S. blogger) says in his blog:</li>
</ul>
<blockquote>
<p>Label Encoding is a feature encoding method which takes a categorical variable and converts the unique possibilities to a sequence of numerical values.</p>
</blockquote>
<div class="cell">
<div class="cell-output-display">
<table>
<thead>
<tr class="header">
<th style="text-align: right;">CustomerID</th>
<th style="text-align: left;">City</th>
<th style="text-align: right;">City_LabEncoded</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">Oslo</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Stockholm</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">Copenhagen</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<ul>
<li>Why would you assign an ‘order’ where there is none? Why would you use LabelEncoding instead of a One-Hot encoding?</li>
</ul>
</section>
<section id="answer-ex.4-label-encoding-can-make-tree-based-algorithms-perform-better" class="slide level2 smaller">
<h2>Answer Ex.4: Label Encoding can make tree-based algorithms perform better</h2>
<div class="columns">
<div class="column">
<p><br> <br></p>
<p>Citing Stephen Allwright again:</p>
<blockquote>
<p>Label Encoding a categorical variable is a method which works best for tree-based models as these do a good job of splitting values in a feature. The tradeoff with Label Encoding is that it’s not approrpiate for all types of machine learning models and it’s difficult to interpet analysis such as feature importance after training.</p>
</blockquote>
</div><div class="column">
<p><br> <br></p>
<p><img data-src="assets/weird_category.gif" alt="GIF of a blogger saying 'This fits in the kind of weird, unique, strange, category'"></p>
</div>
</div>
</section>
<section id="summary" class="slide level2 smaller">
<h2>Summary</h2>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="assets/optimus-prime-trucker.gif"></p>
<p></p><figcaption>Target feature Engineering</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="assets/something-feels-missing-the-encore.gif"></p>
<p></p><figcaption>Missing Values</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="assets/math-calculate.gif"></p>
<p></p><figcaption>Numeric feature engineering</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="assets/weird_category.gif"></p>
<p></p><figcaption>Categorical feature engineering</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="assets/recipe.gif"></p>
<p></p><figcaption>Proper Implementation</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Meeting_2_Ch3_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Meeting_2_Ch3_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Meeting_2_Ch3_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Meeting_2_Ch3_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Meeting_2_Ch3_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Meeting_2_Ch3_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Meeting_2_Ch3_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Meeting_2_Ch3_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Meeting_2_Ch3_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Meeting_2_Ch3_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1200,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        function fireSlideChanged(previousSlide, currentSlide) {

          // dispatch for htmlwidgets
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for reveal
        if (window.Reveal) {
          window.Reveal.addEventListener("slidechanged", function(event) {
            fireSlideChanged(event.previousSlide, event.currentSlide);
          });
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        setTimeout(function() {
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          let href = ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const cites = ref.parentNode.getAttribute('data-cites').split(' ');
        tippyHover(ref, function() {
          var popup = window.document.createElement('div');
          cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    });
    </script>
    

</body></html>